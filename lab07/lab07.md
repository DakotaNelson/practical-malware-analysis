Lab 7-1
=======

  1. This program runs as a service, which causes it to be restarted when the computer is restarted.

  2. This program uses a mutex (`HGL345`) to ensure that only one copy of it runs on a machine at a time.

  3. The aforementioned mutex is a good host-based indicator for this malware.

  4. This program attempts to open `http://www.malwareanalysisbook.com` with a User-Agent of `Internet Explorer 8.0`, both of which are useful network-based indicators.

  5. This program creates 20 threads which open `http://www.malwareanalysisbook.com` using `InternetOpenUrl`. This happens at midnight on January 1, 2100.
  
  6. The program doesn't finish executing until killed.


Lab 7-2
=======

  1. This program does not appear to implement persistence.

  2. This program opens a url (`http://www.malwareanalysisbook.com/ad.html`) in a browser window.

  3. This program finishes executing after it has opened the browser window.


Lab 7-3
=======

  1. This file appears to open a file mapping of both `C:\\Windows\\System32\\Kernel32.dll` and `Lab07-03.dll`, then execute a large number of operations, suggesting it is modifying one or both of the files. Afterward, it creates a file called `C:\\windows\\system32\\kerne132.dll`, which I suspect contains malicious code and is used as a persistence mechanism. It then loops through files (the subroutine `sub_4011E0`), and includes a check to see if they end with `.exe`, calling `sub_4010A0` if they do. That subroutine then maps a view of the tile and modifies it, including the string `kernel32.dll`. All of this together suggests that this malware creates a malicious DLL, then modifies EXE files on the system to call the new malicious DLL.

  2. The created file, `kerne132.dll` is a good host-based indicator, as is the string in the file, `WARNING_THIS_WILL_DESTROY_YOUR_MACHINE`. The DLL file also contains a mutex, `SADFHUHF`.

  3. `Lab07-03.exe` exists only to establish `Lab07-03.dll` as a persistent backdoor. The DLL file then connects to `127.26.152.13` and can accept two commands, `sleep` and `exec`.

  4. This malware could potentially be removed by deleting the persistence DLL it has created, though I suspect you would also have to repair every EXE on your system to no longer call the malicious DLL. Alternately, you could neuter the malicious DLL so that it's still in place and called but no longer contains malicious code.
