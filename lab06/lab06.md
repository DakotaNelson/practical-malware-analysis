Lab 6-1
=======

  1. Main calls the subroutine `sub_401000`, which contains an if statement.

  2. The subroutine appears to write data out.

  3. Above all else, this program seems to do a lot of useless math. Other than that, it seems to determine whether or not the internet is connected (using `InternetGetConnectedState`).


Lab 6-2
=======

  1. The first subroutine called by `main` determines if there is an internet connection.

  2. The subroutine appears to write data out (printf?).

  3. The second subroutine attempts to open (connect to) `http://www.practicalmalwareanalysis.com/cc.htm".

  4. This subroutine appears to use if statements, and perhaps a for loop.

  5. The User Agent is set to `Internet Explorer 7.5/pma`, and the program reaches out to a set url (see question 3).

  6. This malware attempts to open and read from a specified URL, then expects the URL to contain a string `\<!--` which specifies a command.


Lab 6-3
=======

  1. The new function called from main runs one of several commands.

  2. The new function takes `char` and `LPCSTR lpExistingFileName` parameters.

  3. This new function contains a jump table.

  4. This function can establish persistence by writing an executable into `C:\\Temp\\cc.exe` (or deleting it), add a registry key to run the malware on startup, sleep for a time, or create the `Temp` directory.

  5. Host based indicators include the malware file at `C:\\Temp\\cc.exe`, or the registry key `Software\Microsoft\Windows\CurrentVersion\Run` with the data `C:\\Temp\\cc.exe` and the value `Malware`.

  6. This malware can connect to a URL, retrieve a command, and then perform one of several actions based on that command.


Lab 6-4
=======

  1. In this lab, the malware sleeps after executing a command, then loops back to fetch another command. Additionally, the malware will only run for 24 hours before exiting.

  2. A for loop is now present in main.

  3. The function to fetch a command from the internet now varies its User Agent using the index of the main loop. In addition, it actually cleans up after itself by calling `InternetCloseHandle`.

  4. This program will run for 24 hours.

  5. The new network-based indicators are the varying User Agent string.

  6. This malware will do the same as the previous iteration, but in a loop which will operate for 24 hours rather than only executing one time.
